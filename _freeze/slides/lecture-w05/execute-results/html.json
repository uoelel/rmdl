{
  "hash": "1136c3bd133929d234316c8c030dfefb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Research Methods in Developmental Linguistics -- Week 5\"\nauthor: \"Dr Stefano Coretta\"\ninstitute: \"University of Edinburgh\"\nformat:\n  mono-light-revealjs:\n    theme: [default, custom.scss]\n    history: false\nexecute: \n  echo: false\nfilters:\n  - tachyonsextra\nknitr:\n  opts_chunk:\n    dev: \"ragg_png\"\n---\n\n\n\n\n\n## Case study: Ota 2009\n\n::: box-note\n-   Data from [Ota 2009](https://doi.org/10.1016/j.cognition.2008.12.007).\n\n-   L2 lexical representation of \"near-homophones\": ROCK/LOCK for Japanese speakers.\n:::\n\n![](/img/l1-l2-reps.png){fig-align=\"center\"}\n\n## Ota 2009: design\n\n::: box-note\n-   Semantic-relatedness task.\n\n-   Pairs of written words presented visually.\n\n    -   **Homophones**: SON/SUN \\~ MOON\n\n    -   **Near-homophones**: ROCK/LOCK \\~ KEY\n\n    -   **Minimal pairs**: PEAR/BEAR \\~ FEAR\n:::\n\n. . .\n\n::: box-warning\n**Research hypotheses**\n\nH1. The difference in RTs between unrelated and control is the same in homophones (H) and near-homophones (LR).\n\nH2. There is no difference in RTs in minimal pairs (PB).\n:::\n\n## Ota 2009: the data\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,338 × 12\n   Subject Procedure Version Contrast  Item Condition WordL   WordR   Words.ACC\n   <fct>   <chr>     <chr>   <chr>    <dbl> <chr>     <chr>   <chr>       <dbl>\n 1 1       TrialProc B2      PB           1 Unrelated HIT     BUNCH           1\n 2 1       TrialProc A2      LR           1 Unrelated FALSE   COLLECT         0\n 3 1       TrialProc A2      H           19 Unrelated HELLO   BUY             1\n 4 1       TrialProc B2      PB          18 Control   BACK    FAT             1\n 5 1       TrialProc B1      H            8 Unrelated SALE    SHIP            1\n 6 1       TrialProc B1      H           20 Control   HIRE    LISTEN          1\n 7 1       TrialProc B2      LR           3 Unrelated ORDER   RAW             1\n 8 1       TrialProc A2      PB          13 Control   PART    WIT             1\n 9 1       TrialProc A2      LR          13 Control   BEAM    DAY             1\n10 1       TrialProc B2      H           13 Control   SERVANT MAZE            1\n# ℹ 2,328 more rows\n# ℹ 3 more variables: Words.RT <dbl>, RT_log <dbl>, Item_id <chr>\n```\n\n\n:::\n:::\n\n\n\n## Ota 2009: RTs\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/fig-contr-cond-1.png){#fig-contr-cond width=960}\n:::\n:::\n\n\n\n## Log-normal regression (RTs)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_seed <- 9283\n\nota_bm_1 <- brm(\n  Words.RT ~ 0 + Condition:Contrast,\n  family = lognormal,\n  data = ota2009,\n  seed = my_seed,\n  cores = 4,\n  file = \"data/cache/ota_bm_1\"\n)\n```\n:::\n\n\n\n## Log-normal regression: summary\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: lognormal \n  Links: mu = identity; sigma = identity \nFormula: Words.RT ~ 0 + Condition:Contrast \n   Data: ota2009 (Number of observations: 2338) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                              Estimate Est.Error l-90% CI u-90% CI Rhat\nConditionControl:ContrastH        7.63      0.03     7.58     7.67 1.00\nConditionUnrelated:ContrastH      7.73      0.03     7.69     7.77 1.00\nConditionControl:ContrastLR       7.69      0.03     7.65     7.74 1.00\nConditionUnrelated:ContrastLR     7.75      0.03     7.71     7.80 1.00\nConditionControl:ContrastPB       7.62      0.03     7.58     7.67 1.00\nConditionUnrelated:ContrastPB     7.66      0.03     7.62     7.71 1.00\n                              Bulk_ESS Tail_ESS\nConditionControl:ContrastH        6912     3358\nConditionUnrelated:ContrastH      5402     3137\nConditionControl:ContrastLR       5442     2762\nConditionUnrelated:ContrastLR     5660     3092\nConditionControl:ContrastPB       6370     3379\nConditionUnrelated:ContrastPB     6001     3104\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-90% CI u-90% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.54      0.01     0.52     0.55 1.00     5427     3249\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n\n\n:::\n:::\n\n\n\n## Log-normal regression: expected predictions\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/ota-bm-1-cond-1.png){width=960}\n:::\n:::\n\n\n\n## BUT...\n\n::: box-error\n-   Multiple observations from different participants.\n\n-   Multiple observations from different item lists.\n:::\n\n. . .\n\n::: box-tip\n-   We need to include **varying terms** (also known as random or multilevel effects).\n\n-   Regression models with varying terms are variably known as mixed-effects, multilevel, hierarchical, nested... They are all the same thing.\n:::\n\n## By-subject RTs\n\n\n\n::: {.cell fig_asp='0.5'}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/subj-rts-1.png){width=960}\n:::\n:::\n\n\n\n## By-list RTs\n\n\n\n::: {.cell fig_asp='0.5'}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/list-rts-1.png){width=960}\n:::\n:::\n\n\n\n## By-subject and by-list varying terms\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# took 80 seconds to fit\nota_bm_2 <- brm(\n  Words.RT ~ 0 + Condition:Contrast +\n    (0 + Condition:Contrast | Subject) +\n    (0 + Condition:Contrast | Version),\n  family = lognormal,\n  data = ota2009,\n  seed = my_seed,\n  cores = 4,\n  file = \"data/cache/ota_bm_2\"\n)\n```\n:::\n\n\n\n## By-subject and by-list model: expected predictions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfixef(ota_bm_2, probs = c(0.05, 0.95))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                              Estimate  Est.Error       Q5      Q95\nConditionControl:ContrastH    7.625015 0.09395207 7.476049 7.770602\nConditionUnrelated:ContrastH  7.723296 0.10391597 7.555802 7.887133\nConditionControl:ContrastLR   7.695946 0.09051165 7.561654 7.835997\nConditionUnrelated:ContrastLR 7.751183 0.07944943 7.622998 7.877910\nConditionControl:ContrastPB   7.620571 0.07357574 7.501065 7.736887\nConditionUnrelated:ContrastPB 7.658061 0.07802223 7.533287 7.783413\n```\n\n\n:::\n:::\n\n\n\n## By-subject and by-list model: expected predictions plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/ota-bm-2-cond-1.png){width=960}\n:::\n:::\n\n\n\n## Difference between unrelated and control\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nota_bm_2_draws <- as_draws_df(ota_bm_2, variable = \"b_\", regex = TRUE)\nota_bm_2_draws\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A draws_df: 1000 iterations, 4 chains, and 6 variables\n   b_ConditionControl:ContrastH b_ConditionUnrelated:ContrastH\n1                           7.6                            7.7\n2                           7.7                            7.7\n3                           7.5                            7.7\n4                           7.5                            7.7\n5                           7.5                            7.6\n6                           7.6                            7.6\n7                           7.6                            7.5\n8                           7.6                            7.7\n9                           7.6                            7.7\n10                          7.5                            7.7\n   b_ConditionControl:ContrastLR b_ConditionUnrelated:ContrastLR\n1                            7.6                             7.8\n2                            7.7                             7.7\n3                            7.6                             7.8\n4                            7.6                             7.8\n5                            7.6                             7.7\n6                            7.6                             7.7\n7                            7.6                             7.7\n8                            7.7                             7.7\n9                            7.7                             7.7\n10                           7.6                             7.7\n   b_ConditionControl:ContrastPB b_ConditionUnrelated:ContrastPB\n1                            7.6                             7.7\n2                            7.6                             7.7\n3                            7.6                             7.5\n4                            7.7                             7.6\n5                            7.6                             7.6\n6                            7.6                             7.6\n7                            7.6                             7.7\n8                            7.6                             7.6\n9                            7.7                             7.7\n10                           7.5                             7.7\n# ... with 3990 more draws\n# ... hidden reserved variables {'.chain', '.iteration', '.draw'}\n```\n\n\n:::\n:::\n\n\n\n## Difference between unrelated and control\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Difference between unrelated and control: plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/ota-bm-2-draws-diff-plot-1.png){width=960}\n:::\n:::\n\n\n\n## Difference between unrelated and control: CrIs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nota_bm_2_draws |> \n  pivot_longer(diff_h:diff_pb) |> \n  select(name, value) |> \n  group_by(name) |> \n  summarise_draws(~quantile(.x, probs = c(0.05, 0.95))) |> \n  mutate(\n    across(where(is.numeric), ~round(.x, digits = 2))\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n# Groups:   name [3]\n  name    variable  `5%` `95%`\n  <chr>   <chr>    <dbl> <dbl>\n1 diff_h  value    -0.08  0.28\n2 diff_lr value    -0.11  0.2 \n3 diff_pb value    -0.08  0.15\n```\n\n\n:::\n:::\n\n\n\n## Difference of difference LR/H\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lecture-w05_files/figure-revealjs/ota-bm-2-draws-diff-diff-diff-cri-1.png){width=960}\n:::\n:::\n\n\n\n## Difference of difference: CrIs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nota_bm_2_draws |> \n  select(diff_lr_h) |> \n  summarise_draws(~quantile(.x, probs = c(0.05, 0.95))) |> \n  mutate(\n    across(where(is.numeric), ~round(.x, digits = 2))\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  variable   `5%` `95%`\n  <chr>     <dbl> <dbl>\n1 diff_lr_h -0.27  0.18\n```\n\n\n:::\n:::\n\n\n\n## Results overview\n\n::: box-note\nH1. The difference in RTs between unrelated and control is the same in homophones (H) and near-homophones (LR).\n\n- Not enough evidence to assess (CrI [-0.27, 0.18]).\n\nH2. There is no difference in RTs in minimal pairs (PB).\n\n- Not enough evidence to assess (CrI [-0.08, 0.15]).\n:::\n\n## Summary\n\n::: box-tip\n-   You should include varying terms if data is \"hierarchical\", for example repeated measures from subjects or items.\n\n- Not including varying terms (wrongly) inflates posterior certainty.\n\n- Frequentist regression models with lme4 often don't converge and researchers simplify the hierarchical structure of the model.\n:::\n",
    "supporting": [
      "lecture-w05_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}